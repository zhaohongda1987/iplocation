<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title>layui</title>
	<meta name="renderer" content="webkit">
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
	<link href="/iplocation/resources/js/layer/css/layui.css" rel="stylesheet">
</head>
<body>
	<div class="layui-tab layui-tab-brief" lay-filter="docDemoTabBrief">
		<ul class="layui-tab-title">
    		<li class="layui-this" lay-id="1">Table</li>
    		<li lay-id="2">Pie chart</li>
  	</ul>
  	<div class="layui-tab-content">
    	<div class="layui-tab-item layui-show">
        	<table class="layui-table" id="layui-table"></table>
    	</div>
    	<div class="layui-tab-item">
    		<div id="pieChart" style="min-width: 700px; height: 400px"></div>
        </div>
  	</div>
  	<script src="/iplocation/resources/js/layer/layui.js" charset="utf-8"></script>
  	<script src="/iplocation/resources/js/echart/echarts-all.js" charset="utf-8"></script>
  	<script>
    var chartData = ${chartData};
    layui.use(['element', 'table'], function(){
      var $ = layui.jquery
      ,element = layui.element
      ,table = layui.table;
      
      // hash get lay id
      var layId = location.hash.replace(/^#docDemoTabBrief=/, '');
      element.tabChange('docDemoTabBrief', layId);
      element.on('tab(docDemoTabBrief)', function(){
      	var id = this.getAttribute('lay-id');
      	if(id==2) {
      		drawPie(chartData.pieData);
      	}
      });
      // table
      table.render({
        elem: '#layui-table',
        cols: [[
          {checkbox: true, fixed: true}
          ,{field:'country', title: 'country', width:160, sort: true, fixed: true}
          ,{field:'num', title: 'num', width:120, sort: true, fixed: true}
        ]]
        ,data: chartData.tableData
        ,page: true
        ,loading: true
        ,skin: 'line'
        ,even: true
      });
      // pie chart
      var drawPie = function(config) {
      	var myChart = echarts.init(document.getElementById("pieChart"));
      	option = {
        	title : {
          		text: 'Country Data',
          		subtext: 'top 10',
          		x:'center'
        	},
        	tooltip : {
        		trigger: 'item',
        		formatter: "{a} <br/>{b} : {c} ({d}%)"
    		},
        	legend : {
          		orient : 'vertical',
          		x : 'left',
          		data : config.legend
        	},
        	toolbox: {
        		show : true,
        		feature : {
            		mark : {show: true},
            		dataView : {show: true, readOnly: false},
            		magicType : {
                		show: true, 
                		type: ['pie', 'funnel'],
                		option: {
                    		funnel: {
                        		x: '25%',
                        		width: '50%',
                        		funnelAlign: 'left',
                        		max: config.max
                    		}
                		}
            		},
            		restore : {show: true},
            		saveAsImage : {show: true}
        		}
    		},
    		calculable : true,
        	series : [ {
          		name : 'Country Name',
          		type : 'pie',
          		radius : '55%',
          		center : [ '50%', '60%' ],
          		data : config.data
        	} ]
      	};
      	myChart.setOption(option);
      };
      // active
      var active = {
        tabChange: function(){
          // change tab
          element.tabChange();
        }
      };
    });
    </script>
</body>
</html>